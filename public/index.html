<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Banano</title>
<link rel="stylesheet" href="/style.css">
</head>
<body>
  <div id="app">
    <!-- ギャラリー画面 -->
    <div id="gallery-view">
      <div class="btn-row">
        <label class="btn btn-secondary">
          アップロード
          <input type="file" accept="image/*" hidden onchange="uploadImage(this.files[0])">
        </label>
        <button class="btn btn-primary" onclick="showDetail(null)">新規生成</button>
      </div>
      <div class="tab-bar">
        <div class="tab active" data-filter="favorites" onclick="switchTab(this)">お気に入り</div>
        <div class="tab" data-filter="all" onclick="switchTab(this)">すべて</div>
      </div>
      <div id="gallery-grid" class="grid"></div>
      <div id="empty-state" class="empty-state hidden">
        <div class="icon">&#9734;</div>
        <div>お気に入りがありません</div>
        <div class="sub">画像をアップロードまたは生成して始めましょう</div>
      </div>
    </div>

    <!-- 詳細画面 -->
    <div id="detail-view" class="hidden">
      <!-- 戻るボタン (ベースなし生成時) -->
      <div id="detail-back-top" class="detail-back-top hidden" onclick="goBack()">&larr; 戻る</div>

      <!-- 親画像 -->
      <div id="parent-section" class="hidden">
        <div id="parent-thumb" class="img-thumb" onclick="navigateToParent()"></div>
      </div>

      <!-- 選択画像 -->
      <div id="selected-section">
        <div class="selected-image-wrap">
          <div id="selected-image" class="selected-image"></div>
          <div class="overlay-back" onclick="goBack()">&larr;</div>
          <div id="overlay-fav" class="overlay-fav"></div>
        </div>
      </div>

      <!-- 生成フォーム -->
      <div id="gen-form-toggle" class="gen-form-toggle hidden" onclick="toggleGenForm()">＋ 追加生成</div>
      <div id="gen-form-body" class="generate-form">
        <div class="option-row">
          <span class="option-label">モデル</span>
          <select id="gen-model" onchange="onModelChange()"></select>
        </div>
        <label class="input-label">プロンプト</label>
        <div id="gen-prompt-history" class="prompt-history"></div>
        <textarea id="gen-prompt" placeholder="生成内容を入力..."></textarea>
        <div class="option-row">
          <span class="option-label">枚数</span>
          <div id="gen-count-btns" class="count-btns">
            <span class="count-btn" onclick="setCount(1)">1</span>
            <span class="count-btn" onclick="setCount(2)">2</span>
            <span class="count-btn active" onclick="setCount(3)">3</span>
          </div>
          <input type="number" id="gen-count" value="3" min="1" max="3" class="hidden">
        </div>
        <div class="option-row" id="temp-row">
          <span class="option-label">Temperature</span>
          <input type="range" id="gen-temp" min="0" max="2" step="0.1" value="1.0" oninput="document.getElementById('gen-temp-val').textContent=this.value">
          <span id="gen-temp-val" class="slider-val">1.0</span>
        </div>
        <div class="option-row">
          <span class="option-label">アスペクト比</span>
          <select id="gen-aspect">
            <option value="auto">自動</option>
            <option value="1:1">1:1</option>
            <option value="3:4">3:4</option>
            <option value="4:3">4:3</option>
            <option value="9:16">9:16</option>
            <option value="16:9">16:9</option>
          </select>
        </div>
        <button id="gen-btn" class="btn btn-primary" onclick="generate()">生成する</button>
        <div id="gen-progress" class="hidden">
          <div class="progress"><div id="gen-progress-bar" class="progress-bar"></div></div>
          <div id="gen-progress-text" class="progress-text"></div>
        </div>
      </div>

      <!-- 子画像 (レビューUI) -->
      <div id="children-section" class="hidden">
        <div id="children-viewer" class="children-viewer">
          <div class="review-arrow review-arrow-l" onclick="reviewPrev()">&lsaquo;</div>
          <img id="children-viewer-img">
          <div class="review-arrow review-arrow-r" onclick="reviewNext()">&rsaquo;</div>
          <div id="children-counter" class="review-counter"></div>
          <div class="review-actions-overlay">
            <div id="children-fav-btn" class="review-btn review-btn-fav" onclick="reviewToggleFav()">&#9734;</div>
            <div id="children-dots" class="review-dots-inline"></div>
            <div class="review-btn review-btn-use" onclick="reviewUseAsBase()">ベースに生成</div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script src="/app.js"></script>
</body>
</html>
